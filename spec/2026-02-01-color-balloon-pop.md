# 2026-02-01 — 彩色氣球爆爆樂（Color Balloon Pop）

> 目標年齡：3–12 歲
> 
> 核心：看到「目標顏色」→ 只點同色氣球把它爆掉。

## 1. 玩法（Game Loop）

- 遊戲時間：60 秒（可在設定中改成 30/60/90 秒）。
- 畫面會顯示一個「目標顏色」(例如：紅色)。
- 氣球從畫面底部緩慢往上飄（混合多種顏色）。
- 玩家用點擊/點按把氣球戳破：
  - 點到**目標顏色**：得分 + 連擊增加，播放「啵」音效與小爆炸粒子。
  - 點到**非目標顏色**：扣 1 顆心（生命），播放「噗」失誤音效與紅色閃屏。
- 生命值：3 顆心。心用完或時間到 → 結算。
- 每達成一個小里程碑（例如連續命中 5 次或累積 15 分）會隨機切換目標顏色，並提示「換色！」。

## 2. 操作（Controls）

- 手機/平板：單指點按。
- 桌機：滑鼠點擊。
- UI：
  - Start / Restart
  - Mute（音效開關）

## 3. 得分與回饋（Scoring & Feedback）

### 3.1 計分
- 命中目標色：+1 分
- 連擊加成：
  - 連續命中每 +5 次，之後每次命中額外 +1（上限 +3）
  - 例：combo 0–4：+0；5–9：+1；10–14：+2；15+：+3
- 點錯顏色：不加分，扣心。

### 3.2 即時回饋
- 命中：
  - 氣球縮放彈一下、破裂粒子（彩色紙屑）
  - pop 音效（短、清脆）
- 失誤：
  - 1 次紅色閃屏（0.2–0.3s）
  - wrong 音效（低頻、短促）
- 換目標顏色：
  - HUD 文字短暫放大/高亮（0.4s）
  - change 音效（兩音階提示）
- 結束：
  - Game Over 音效（下行音階）

## 4. 難度曲線（Difficulty Curve）

目標：前 10 秒讓 3–5 歲也能理解；後段讓 8–12 歲也有壓力與追分。

- 0–15s（入門）
  - 氣球速度慢、生成數量低
  - 顏色種類 3 種（紅/藍/黃）
- 15–40s（加速）
  - 逐步提高上升速度與生成率
  - 顏色種類增加到 4–5 種（+綠/紫）
- 40–60s（挑戰）
  - 速度更快
  - 部分氣球半透明或更小（提高辨識與點擊精準度需求）

可控縮減：若節奏太忙，維持 4 種顏色，或限制同時在場氣球上限。

## 5. 資產清單（Assets）

> 原則：本日 MVP 盡量使用**程式繪製**（PIXI Graphics），避免外部美術依賴。

- 視覺：
  - 背景：漸層天空 + 幾朵簡單雲
  - 氣球：圓形/橢圓 + 高光 + 小綁線
  - 粒子：小三角/方形紙屑
  - HUD：
    - 目標顏色展示（色塊 + 文字）
    - 分數、連擊、剩餘時間、生命（心形 icon 可用簡單向量）

## 6. 音效設計（SFX Design）

> 使用 WebAudio 產生合成音（無外部音檔），避免版權與載入時間。

- pop（命中目標色）：
  - 觸發：玩家點到目標色氣球
  - 聲音：短「啵」(sine/triangle + 快速包絡)
- wrong（點錯）：
  - 觸發：點到非目標色
  - 聲音：低頻短促（square/triangle）
- change（目標色切換）：
  - 觸發：達成里程碑換色
  - 聲音：兩音上行（提示注意）
- start：
  - 觸發：開始按鈕或第一次點畫面
  - 聲音：短提示音
- gameover：
  - 觸發：時間到或心用完
  - 聲音：下行音階

## 7. 技術方案（Technical Plan）

### 7.1 技術選型
- 2D engine/library：**PixiJS（pixi.js v8）**
- 理由：
  - 專案已內建 pixi.js（零新增依賴）
  - 以 GPU 加速做大量 sprite/粒子效果更穩
  - Pointer 事件與 ticker 迴圈適合小遊戲

### 7.2 架構
- Vue View：`src/views/ColorBalloonPopView.vue`
- 遊戲 Canvas：`src/games/color-balloon-pop/ColorBalloonPopCanvas.vue`
- 主要狀態：
  - `status: ready | playing | gameover`
  - `score, combo, lives, timeLeft`
  - `targetColor`
  - `balloons[]`（位置、速度、顏色、半徑、透明度）
  - `particles[]`（短生命週期）
- 遊戲 loop：使用 PIXI `app.ticker`，每 frame 更新位置、生成、移除、計時。

### 7.3 生成規則（MVP）
- 每 N ms 生成 1 顆氣球（N 隨時間縮短）
- 同時在場上限：例如 18 顆（避免太擠/效能掉）
- 氣球碰到頂端後自動消失（不扣分）

### 7.4 輸入
- 點擊命中：
  - 使用 PIXI `eventMode = 'static'` + pointertap
  - 或自行用距離判斷（保底）

### 7.5 音效
- 參考既有 StarCatcher 的 WebAudio 寫法（Oscillator + Gain envelope）。
- iOS 限制：必須在第一次使用者手勢時 `resume()` AudioContext。

## 8. 風險與縮減（Risks & Scoping）

- 風險：手機上 pointer 事件/點擊命中不穩
  - 縮減：改用「距離判定」而非依賴 PIXI hitArea
- 風險：顏色辨識（色弱）
  - 縮減：目標顏色同時顯示「圖案」(點/線/星)（可延後；本日 MVP 先色塊+文字）
- 風險：粒子太多造成卡頓
  - 縮減：粒子上限 + 生命週期短 + 簡化為 8–12 個小圖形
- 風險：難度太忙
  - 縮減：降低生成率上限，或把顏色固定 4 種

## 9. 驗證清單（Verification Checklist）

- [ ] 可在手機瀏覽器進入並開始遊戲（首次點擊能啟用音效）
- [ ] 點到目標色會加分、連擊會增加
- [ ] 點錯會扣心，心歸零會結束
- [ ] 目標色會在達成里程碑後切換
- [ ] 60 秒倒數結束會結算並可 Restart
- [ ] Mute 可關閉所有音效
- [ ] 效能：一般手機保持流暢（同時氣球上限有效）

---

## 自我檢查與修訂（至少 3 次）

### Revision 1 — 可玩性檢查
- 問題：只有「點對/點錯」可能太單調。
- 調整：加入「里程碑換色」與「連擊加成」，讓孩子有追分目標。

### Revision 2 — 可實作性/範圍檢查
- 問題：若做太多美術會拖慢。
- 調整：全部改為程式繪製（Graphics），背景也用簡單漸層+雲，避免外部素材。

### Revision 3 — 難度/挫折感檢查
- 問題：扣心對 3–5 歲可能太挫折。
- 調整：心數維持 3，但「點錯不扣分」且只扣心；同時早期生成率低、顏色少，讓他們先學會。

---

## Changelog
- v0.1 初稿：確立目標色點擊 + 倒數 60 秒 + 3 心。
- v0.2 加入：連擊加成與里程碑換色，提升可玩性。
- v0.3 縮減：全部程式繪製資產；加入同時氣球上限與效能保底策略。
