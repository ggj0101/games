# 2026-01-31 — 果凍配對（Jelly Match）

> 目標：3–12 歲都能「秒懂就玩」，30 秒內學會；先做到可玩，再加料。

## A. 發想（一句話）
畫面上會漂浮好多彩色果凍，**上方會指定「今天要點的顏色」**；玩家只要點對顏色就得分、越點越快，點錯會扣生命。

---

## B. 技術選型
**選用：HTML Canvas + Vue 3（現有架構）+ WebAudio（合成音效）**

理由：
- 專案現有就用 Vue/Vite，新增一個 Canvas component 成本最低。
- 這個遊戲只需要 2D 簡單幾何渲染、命中判定、少量物理（漂浮/反彈），不需要完整引擎。
- WebAudio 用振盪器做「按鈕/命中/錯誤/連擊」音效：
  - **免資產**、低延遲、部署簡單
  - iOS/手機瀏覽器也可用（需首次點擊後啟用 AudioContext）。

（備案）若後續要大量精靈/粒子/濾鏡，可轉 Pixi.js（專案已依賴）。但今天先用原生 Canvas 讓範圍可控。

---

## C. 規格書

### 1) 核心玩法（Loop）
- 遊戲回合：**45 秒**（可調）。
- 畫面上同時存在 N 顆「果凍」（彩色圓形/泡泡）。
- UI 顯示「目標顏色」：例如「點 **紅色**」。
- 玩家點擊/觸控任一果凍：
  - **點到目標顏色** → 得分 + 連擊（streak）增加，立刻換下一個目標顏色。
  - **點到非目標顏色** → 扣 1 生命、連擊歸零。
  - **點到空白** → 不處罰（避免幼兒挫折），但不加分。
- 生命（Lives）：**3**。生命歸零或時間到 → 結算。

### 2) 操作
- 手機/平板：單指點按。
- 桌面：滑鼠點擊。
- 介面按鈕：Start / Restart / Mute。

### 3) 得分與回饋
- 基礎得分：點對 +1。
- 連擊加成：
  - 連擊每 5 次，之後每次點對額外 +1（上限 +4）。
  - 目的：鼓勵專注、讓大孩子有挑戰。
- 視覺回饋：
  - 點對：小幅「亮起/閃光圈」+ 畫面淡藍閃一下。
  - 點錯：紅色淡閃 + 輕微震動感（僅視覺，先不做真震動 API）。
- 音效回饋（WebAudio）：
  - 點對：依顏色播放不同音高的短 beep。
  - 連擊里程碑（每 10 次）：更亮的雙音。
  - 點錯：低音 down-sweep。
  - 開始/結束：簡短提示音。

### 4) 難度曲線（45 秒內逐步加速）
用「時間進度 t（0→1）」線性或 ease-in：
- 同時果凍數量 N：
  - 前段：6 顆
  - 中段：8 顆
  - 後段：10 顆
- 移動速度：從慢（~35 px/s）逐步到快（~90 px/s）。
- 顏色種類：固定 4 種（紅/藍/黃/綠）。
  - 3–6 歲：顏色少、果凍大
  - 7–12 歲：速度更快、連擊加成明顯

### 5) 資產清單
**MVP 版本 0 資產**（全部程式繪製）：
- 果凍：圓形 + 漸層 + 高光。
- UI：Vuetify 元件。

（可選後續）
- 小貼圖/表情（成功/失敗）

### 6) 音效設計（觸發時機）
- Start：按下 Start → 1 個上揚 beep。
- Hit Correct：點到目標色 → 對應顏色的短 beep（不同頻率）。
- Hit Wrong：點到非目標色 → 低音 down-sweep。
- Streak Milestone：連擊達 10、20、30… → 雙音提示。
- Game Over：時間到或生命歸零 → down-sweep + 長一點的低音。
- Mute/Unmute：切換時播放極短提示（可選）。

### 7) 技術方案（實作要點）
- 渲染：Canvas 2D，固定 CSS 高度（例如 480），寬度跟隨容器。
- DPR：依 devicePixelRatio 設定 canvas.width/height，ctx.setTransform(dpr,0,0,dpr,0,0)。
- 物件：Jelly { id, color, x,y,r, vx,vy }。
- 碰撞：邊界反彈（避免複雜碰撞）。
- 目標顏色：從顏色池隨機挑選，避免與前一個連續相同（減少無聊）。
- 命中判定：pointer 坐標轉 canvas CSS 坐標後，用距離 <= r。
- 音效：類似 StarCatcher，用 AudioContext + Oscillator + Gain 包裝 `beep()`。
- 狀態：ready / playing / gameover；timeLeft、score、lives、streak。

### 8) 風險與縮減（Scope Control）
- 風險：移動 + 命中判定在手機上要「夠大好點」。
  - 縮減：果凍半徑 >= 22px；點到空白不惩罚。
- 風險：音效在 iOS 需要 user gesture 才能播放。
  - 縮減：Start/第一次 pointerdown 時呼叫 ensureAudio()。
- 風險：難度太快造成挫折。
  - 縮減：錯誤只扣生命不扣分；生命 3→5 可調。
- 風險：範圍膨脹（特效/粒子/排行榜）。
  - 縮減：今天只做「能玩 + 有音效 + 可結算」。

### 9) 驗證清單（Definition of Done）
- [ ] 手機可用單指點按，不會觸發頁面捲動/文字選取。
- [ ] Start 後 45 秒倒數，時間到自動結束。
- [ ] 顯示 target color；點對加分並換下一個目標。
- [ ] 點錯扣生命、生命歸零會結束。
- [ ] 連擊規則生效（至少能看得出差異）。
- [ ] 有基本音效（Start / hit / wrong / end）且可 Mute。
- [ ] 路由/首頁可進入新遊戲。

---

## D. 自我檢查修訂（至少 3 次）

### Revision 1 — 可玩性
- 問題：若點空白也扣血，3–6 歲會很挫折。
- 調整：**點空白不處罰**；只對「點錯果凍」扣血。

### Revision 2 — 可實作性
- 問題：做果凍互相碰撞會把物理搞很大。
- 調整：**只做邊界反彈**，不做果凍互撞；透過控制數量與速度達到忙碌感。

### Revision 3 — 範圍可控
- 問題：想做太多（粒子、震動、排行榜）。
- 調整：今天 MVP 僅做：**倒數回合、點對/點錯、連擊加成、音效、路由入口**；其餘列為後續。

---

## Changelog
- v0.1 (2026-01-31) 初稿：Jelly Match 玩法/操作/得分/難度/音效/技術方案/風險與驗證清單。
